<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>V√≤ng quay may m·∫Øn</title>
<style>
body{
  font-family: Arial, sans-serif;
  text-align:center;
  background:#f5f5f5;
}
h2{margin-top:20px}
#turns{
  background:#000;
  color:#00ff00;
  padding:10px;
  border-radius:20px;
  width:220px;
  margin:10px auto;
}
.wheel-box{
  position:relative;
  width:300px;
  height:300px;
  margin:20px auto;
}
#wheel{
  width:100%;
  height:100%;
  border-radius:50%;
  transition: transform 4s cubic-bezier(.17,.67,.14,1);
}
.pointer{
  position:absolute;
  top:-8px;
  left:50%;
  transform:translateX(-50%);
  width:0;
  height:0;
  border-left:14px solid transparent;
  border-right:14px solid transparent;
  border-bottom:28px solid red;
}
button{
  background:#ff5722;
  color:#fff;
  border:none;
  padding:15px 40px;
  border-radius:30px;
  font-size:18px;
  cursor:pointer;
}
button:disabled{opacity:.5}
</style>
</head>

<body>

<h2>V√≤ng quay may m·∫Øn</h2>
<div id="turns">üéü L∆∞·ª£t c√≤n l·∫°i: <span id="count">5</span></div>

<div class="wheel-box">
  <div class="pointer"></div>
  <canvas id="wheel" width="300" height="300"></canvas>
</div>

<button id="spinBtn">üéØ QUAY NGAY</button>

<script>
const prizes = [
  "Ch√∫c may m·∫Øn",
  "M·∫•t l∆∞·ª£t",
  "Th√™m l∆∞·ª£t",
  "3 gi·ªè qu√† T·∫øt",
  "+50.000ƒë",
  "+100.000ƒë",
  "M√°y s·∫•y t√≥c",
  "·∫§m si√™u t·ªëc",
  "ƒêi·ªán tho·∫°i Samsung"
];

const colors = [
  "#ccc","#4fc3f7","#ba68c8","#ffcc80",
  "#81c784","#4db6ac","#ffd54f","#ffb74d","#ef5350"
];

const canvas = document.getElementById("wheel");
const ctx = canvas.getContext("2d");
const size = prizes.length;
const arc = 2 * Math.PI / size;
let currentRotation = 0;
let spinning = false;
let turns = 5;

function drawWheel(){
  for(let i=0;i<size;i++){
    ctx.beginPath();
    ctx.fillStyle = colors[i];
    ctx.moveTo(150,150);
    ctx.arc(150,150,150,i*arc,(i+1)*arc);
    ctx.fill();

    ctx.save();
    ctx.translate(150,150);
    ctx.rotate(i*arc + arc/2);
    ctx.textAlign="right";
    ctx.fillStyle="#000";
    ctx.font="14px Arial";
    ctx.fillText(prizes[i],140,5);
    ctx.restore();
  }
}
drawWheel();

document.getElementById("spinBtn").onclick = ()=>{
  if(spinning || turns<=0) return;
  spinning = true;

  turns--;
  document.getElementById("count").innerText = turns;

  const index = Math.floor(Math.random() * size);

  // üî• C√îNG TH·ª®C CHU·∫®N ‚Äì KIM TR√ôNG 100%
  const sliceDeg = 360 / size;
  const targetDeg =
    360 * 5 +
    (360 - index * sliceDeg - sliceDeg / 2) -
    90; // FIX L·ªÜCH CANVAS

  currentRotation += targetDeg;
  canvas.style.transform = `rotate(${currentRotation}deg)`;

  setTimeout(()=>{
    alert("K·∫øt qu·∫£: " + prizes[index]);

    if(prizes[index] === "Th√™m l∆∞·ª£t"){
      turns++;
      document.getElementById("count").innerText = turns;
    }
    spinning = false;
  },4200);
};
</script>

</body>
</html>
