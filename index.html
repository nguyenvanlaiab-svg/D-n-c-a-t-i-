<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>VÃ²ng quay may máº¯n</title>
<style>
body{
  font-family: Arial, Helvetica, sans-serif;
  background:#f5f5f5;
  text-align:center;
  margin:0;
}
h1{margin:20px 0}
.top{
  background:#111;
  color:#00ff66;
  padding:12px;
  font-weight:bold;
  border-radius:10px;
  margin:0 16px 10px;
}
.box{
  position:relative;
  width:320px;
  margin:20px auto;
}
canvas{display:block;margin:auto}
.pointer{
  position:absolute;
  top:-10px; left:50%;
  transform:translateX(-50%);
  width:0;height:0;
  border-left:14px solid transparent;
  border-right:14px solid transparent;
  border-bottom:26px solid red;
}
.btn{
  margin-top:20px;
  background:#f2552c;
  color:#fff;
  border:none;
  padding:14px 40px;
  font-size:18px;
  border-radius:10px;
  font-weight:bold;
}
.popup{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.6);
  display:none;
  align-items:center;
  justify-content:center;
}
.popup-box{
  background:#fff;
  padding:20px;
  width:260px;
  border-radius:14px;
}
.popup-box h3{margin:0 0 10px}
</style>
</head>

<body>

<h1>VÃ²ng quay may máº¯n</h1>
<div class="top">ðŸŽ« LÆ°á»£t cÃ²n láº¡i: <span id="turns">5</span></div>

<div class="box">
  <div class="pointer"></div>
  <canvas id="wheel" width="300" height="300"></canvas>
</div>

<button class="btn" onclick="spin()">ðŸŽ¯ QUAY NGAY</button>

<div class="popup" id="popup">
  <div class="popup-box">
    <h3 id="popTitle"></h3>
    <p id="popMsg"></p>
    <button class="btn" onclick="closePop()">OK</button>
  </div>
</div>

<script>
const prizes=[
 {t:"+50.000Ä‘",w:1},
 {t:"+100.000Ä‘",w:1},
 {t:"+200.000Ä‘",w:1},
 {t:"+300.000Ä‘",w:1},
 {t:"+500.000Ä‘",w:1},
 {t:"-70.000Ä‘",w:1},
 {t:"-80.000Ä‘",w:1},
 {t:"-90.000Ä‘",w:1},
 {t:"-200.000Ä‘",w:1},
 {t:"Máº¥t lÆ°á»£t",w:1},
 {t:"ThÃªm lÆ°á»£t",w:1},
 {t:"ChÃºc may máº¯n",w:1},

 // giáº£i trÆ°ng bÃ y â€“ 0%
 {t:"ðŸŽ 3 giá» quÃ  Táº¿t",w:0},
 {t:"ðŸ“± Äiá»‡n thoáº¡i Samsung",w:0},
 {t:"ðŸ’¨ MÃ¡y sáº¥y tÃ³c",w:0},
 {t:"ðŸ”¥ BÃ n lÃ ",w:0},
];

const colors=["#2ecc71","#27ae60","#16a085","#f1c40f","#f39c12",
"#e67e22","#d35400","#c0392b","#e74c3c","#3498db",
"#9b59b6","#95a5a6","#f7d794","#feca57","#48dbfb","#ff9ff3"];

const c=document.getElementById("wheel");
const ctx=c.getContext("2d");
const r=c.width/2;
let angle=0,spinning=false,turns=5;

function draw(){
  const step=2*Math.PI/prizes.length;
  prizes.forEach((p,i)=>{
    ctx.beginPath();
    ctx.moveTo(r,r);
    ctx.arc(r,r,r,i*step+angle,(i+1)*step+angle);
    ctx.fillStyle=colors[i%colors.length];
    ctx.fill();
    ctx.save();
    ctx.translate(r,r);
    ctx.rotate(i*step+step/2+angle);
    ctx.textAlign="right";
    ctx.fillStyle="#000";
    ctx.font="14px Arial";
    ctx.fillText(p.t,r-10,5);
    ctx.restore();
  });
}
draw();

function spin(){
  if(spinning||turns<=0) return;
  turns--;
  document.getElementById("turns").innerText=turns;
  spinning=true;

  // chá»‰ chá»n Ã´ w>0
  const pool=[];
  prizes.forEach((p,i)=>{if(p.w>0)for(let k=0;k<p.w;k++)pool.push(i)});
  const pick=pool[Math.floor(Math.random()*pool.length)];
  const step=2*Math.PI/prizes.length;
  const target=pick*step;
  let speed=0.35;

  (function anim(){
    speed*=0.985;
    angle+=speed;
    draw();
    if(speed<0.002){
      spinning=false;
      show(prizes[pick].t);
      return;
    }
    requestAnimationFrame(anim);
  })();
}

function show(text){
  document.getElementById("popup").style.display="flex";
  document.getElementById("popTitle").innerText="ðŸŽ‰ Káº¿t quáº£";
  document.getElementById("popMsg").innerText=text;
}
function closePop(){
  document.getElementById("popup").style.display="none";
}
</script>

</body>
</html>
