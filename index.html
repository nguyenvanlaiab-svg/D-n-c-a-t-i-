<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>V√≤ng quay may m·∫Øn</title>
<style>
body{
  margin:0;
  background:#f5f5f5;
  font-family:Arial,Helvetica,sans-serif;
  display:flex;
  justify-content:center;
  align-items:center;
  height:100vh;
}
.box{
  background:#fff;
  padding:20px;
  border-radius:16px;
  box-shadow:0 10px 30px rgba(0,0,0,.15);
  text-align:center;
}
canvas{margin:10px auto;display:block}
button{
  background:#ee4d2d;
  color:#fff;
  border:none;
  padding:12px 30px;
  border-radius:25px;
  font-size:18px;
  font-weight:bold;
}
button:disabled{background:#aaa}
#turns{margin-top:10px;font-weight:bold}
#result{margin-top:10px;font-size:16px;font-weight:bold}
#popup{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.5);
  display:none;
  justify-content:center;
  align-items:center;
}
.popup-box{
  background:#fff;
  padding:25px;
  border-radius:16px;
  text-align:center;
  width:280px;
}
.popup-box h2{margin:0 0 10px}
.popup-box button{margin-top:15px}
</style>
</head>
<body>

<div class="box">
  <h2>üéÅ V√≤ng quay may m·∫Øn</h2>
  <canvas id="wheel" width="300" height="300"></canvas>
  <button id="spinBtn">QUAY</button>
  <div id="turns">L∆∞·ª£t c√≤n l·∫°i: 5</div>
  <div id="result"></div>
</div>

<div id="popup">
  <div class="popup-box">
    <h2 id="popupTitle"></h2>
    <div id="popupMsg"></div>
    <button onclick="closePopup()">OK</button>
  </div>
</div>

<script>
// ===== DANH S√ÅCH √î =====
const prizes=[
 "Ch√∫c may m·∫Øn l·∫ßn sau",
 "Tr∆∞·ª£t",
 "Th√™m l∆∞·ª£t",
 "M·∫•t l∆∞·ª£t",
 "Jackpot 5 tri·ªáu üí∞",
 "3 gi·ªè qu√† T·∫øt üéÅ",
 "·∫§m si√™u t·ªëc üî•",
 "ƒêi·ªán tho·∫°i Samsung üì±",
 "M√°y s·∫•y t√≥c üí®"
];

// ===== CH·ªà S·ªê √î ƒê∆Ø·ª¢C PH√âP TR√öNG (KH√îNG GI·∫¢I) =====
const SAFE_INDEXES = [0,1]; 
// 0 = Ch√∫c may m·∫Øn l·∫ßn sau
// 1 = Tr∆∞·ª£t
// => T·∫§T C·∫¢ GI·∫¢I TH∆Ø·ªûNG = 0%

let turns=5,spinning=false,angle=0;
const canvas=document.getElementById("wheel");
const ctx=canvas.getContext("2d");
const center=150,radius=140;
const step=2*Math.PI/prizes.length;

function drawWheel(){
 ctx.clearRect(0,0,300,300);
 for(let i=0;i<prizes.length;i++){
  const start=i*step;
  ctx.beginPath();
  ctx.moveTo(center,center);
  ctx.arc(center,center,radius,start,start+step);
  ctx.fillStyle=i%2?"#ffecec":"#fff3e0";
  ctx.fill();
  ctx.save();
  ctx.translate(center,center);
  ctx.rotate(start+step/2);
  ctx.textAlign="right";
  ctx.fillStyle="#000";
  ctx.font="14px Arial";
  ctx.fillText(prizes[i],radius-10,5);
  ctx.restore();
 }
 // kim
 ctx.fillStyle="red";
 ctx.beginPath();
 ctx.moveTo(center-10,10);
 ctx.lineTo(center+10,10);
 ctx.lineTo(center,30);
 ctx.fill();
}
drawWheel();

document.getElementById("spinBtn").onclick=()=>{
 if(spinning||turns<=0)return;
 spinning=true;
 turns--;
 document.getElementById("turns").innerText="L∆∞·ª£t c√≤n l·∫°i: "+turns;

 // üéØ CH·ªåN K·∫æT QU·∫¢ CH·∫ÆC CH·∫ÆN KH√îNG TR√öNG
 const targetIndex = SAFE_INDEXES[Math.floor(Math.random()*SAFE_INDEXES.length)];
 const targetAngle = (prizes.length - targetIndex) * step + Math.random()*step;

 let speed=0.5;
 const anim=()=>{
  speed*=0.985;
  angle+=speed;
  ctx.save();
  ctx.translate(center,center);
  ctx.rotate(angle);
  ctx.translate(-center,-center);
  drawWheel();
  ctx.restore();
  if(speed<0.002){
   spinning=false;
   angle = targetAngle;
   const prize = prizes[targetIndex];
   document.getElementById("result").innerText="üéâ "+prize;
   document.getElementById("turns").innerText="L∆∞·ª£t c√≤n l·∫°i: "+turns;
   showPopup("K·∫øt qu·∫£",prize);
   return;
  }
  requestAnimationFrame(anim);
 };
 anim();
};

function showPopup(t,m){
 document.getElementById("popupTitle").innerText=t;
 document.getElementById("popupMsg").innerText=m;
 document.getElementById("popup").style.display="flex";
}
function closePopup(){
 document.getElementById("popup").style.display="none";
}
</script>

</body>
</html>
