<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>VÃ²ng quay may máº¯n</title>

<style>
body{
  margin:0;
  font-family: Arial, Helvetica, sans-serif;
  background:#f5f5f5;
  text-align:center;
}
h2{margin:12px 0}
.top{
  margin:10px;
  padding:10px;
  background:#111;
  color:#0f0;
  border-radius:10px;
  font-weight:bold;
}
canvas{margin-top:10px}
#spinBtn{
  margin-top:15px;
  padding:14px 36px;
  font-size:18px;
  border:none;
  border-radius:12px;
  background:#ee4d2d;
  color:#fff;
  font-weight:bold;
}
#spinBtn:disabled{background:#999}
#result{margin-top:10px;font-size:18px;font-weight:bold}

/* popup shopee */
#popupOverlay{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.55);
  display:none;
  align-items:center;
  justify-content:center;
  z-index:9999;
}
#popupBox{
  width:88%;
  max-width:320px;
  background:#fff;
  border-radius:16px;
  padding:18px 16px;
  text-align:center;
}
#popupIcon{font-size:40px}
#popupTitle{font-size:18px;font-weight:700;margin:6px 0}
#popupMsg{font-size:15px;color:#444;margin:6px 0 14px}
#popupBtn{
  width:100%;
  border:none;
  border-radius:12px;
  padding:12px 0;
  font-size:16px;
  font-weight:700;
  background:#ee4d2d;
  color:#fff;
}
</style>
</head>

<body>

<h2>VÃ²ng quay may máº¯n</h2>
<div class="top">ðŸŽ« LÆ°á»£t cÃ²n láº¡i: <span id="turns">5</span></div>

<canvas id="wheel" width="300" height="300"></canvas>
<br>
<button id="spinBtn" onclick="spin()">ðŸŽ¯ QUAY NGAY</button>
<div id="result"></div>

<!-- POPUP -->
<div id="popupOverlay">
  <div id="popupBox">
    <div id="popupIcon">ðŸŽ‰</div>
    <div id="popupTitle">ChÃºc má»«ng!</div>
    <div id="popupMsg">Báº¡n nháº­n Ä‘Æ°á»£c pháº§n thÆ°á»Ÿng</div>
    <button id="popupBtn" onclick="closePopup()">OK</button>
  </div>
</div>

<script>
/* ====== DATA ====== */
const prizes = [
  "ðŸŽ 3 giá» quÃ  Táº¿t",
  "ðŸŽ 3 giá» quÃ  Táº¿t",
  "+50.000Ä‘",
  "+100.000Ä‘",
  "+200.000Ä‘",
  "+300.000Ä‘",
  "+500.000Ä‘",
  "-70.000Ä‘",
  "-80.000Ä‘",
  "-90.000Ä‘",
  "-200.000Ä‘",
  "Máº¥t lÆ°á»£t",
  "ThÃªm lÆ°á»£t",
  "ChÃºc may máº¯n"
];

const colors = [
  "#ffd180","#ffd180",
  "#66bb6a","#43a047","#26a69a","#ffd54f","#ffb300",
  "#ffa726","#fb8c00","#ef5350","#d32f2f",
  "#42a5f5","#ab47bc","#9e9e9e"
];

let turns = 5;
let angle = 0;
let spinning = false;

/* ====== CANVAS ====== */
const canvas = document.getElementById("wheel");
const ctx = canvas.getContext("2d");
const center = canvas.width/2;
const radius = center-5;
const step = 2*Math.PI/prizes.length;

function drawWheel(){
  ctx.clearRect(0,0,canvas.width,canvas.height);
  prizes.forEach((t,i)=>{
    const start = angle + i*step;
    ctx.beginPath();
    ctx.moveTo(center,center);
    ctx.arc(center,center,radius,start,start+step);
    ctx.fillStyle = colors[i%colors.length];
    ctx.fill();

    ctx.save();
    ctx.translate(center,center);
    ctx.rotate(start + step/2);
    ctx.textAlign="right";
    ctx.fillStyle="#000";
    ctx.font="14px Arial";
    ctx.fillText(t, radius-10,5);
    ctx.restore();
  });
  // kim
  ctx.fillStyle="red";
  ctx.beginPath();
  ctx.moveTo(center-10,5);
  ctx.lineTo(center+10,5);
  ctx.lineTo(center,25);
  ctx.fill();
}
drawWheel();

/* ====== SPIN ====== */
function spin(){
  if(spinning || turns<=0) return;

  turns--;
  document.getElementById("turns").innerText = turns;
  if(turns===0) document.getElementById("spinBtn").disabled=true;

  spinning=true;
  let speed = Math.random()*0.3 + 0.35;
  const decel = 0.995;

  function anim(){
    speed*=decel;
    angle+=speed;
    drawWheel();
    if(speed<0.002){
      spinning=false;
      const idx = Math.floor(
        prizes.length - (angle%(2*Math.PI))/step
      ) % prizes.length;

      const prize = prizes[idx];
      document.getElementById("result").innerText = "ðŸŽ‰ " + prize;

      if(prize.includes("3 giá»")){
        showPopup("ChÃºc má»«ng!", "Báº¡n trÃºng 3 giá» quÃ  Táº¿t ðŸŽðŸŽðŸŽ","ðŸŽ‰");
      }else{
        showPopup("Káº¿t quáº£", prize,"ðŸŽ¯");
      }
      return;
    }
    requestAnimationFrame(anim);
  }
  anim();
}

/* ====== POPUP ====== */
function showPopup(title,msg,icon){
  document.getElementById("popupTitle").innerText=title;
  document.getElementById("popupMsg").innerText=msg;
  document.getElementById("popupIcon").innerText=icon;
  document.getElementById("popupOverlay").style.display="flex";
}
function closePopup(){
  document.getElementById("popupOverlay").style.display="none";
}
</script>

</body>
</html>
