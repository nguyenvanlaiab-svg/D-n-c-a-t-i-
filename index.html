<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>VÃ²ng quay may máº¯n</title>

<style>
body{margin:0;font-family:Arial;text-align:center;background:#fff}
h1{margin:15px 0}
.top-bar{background:#111;color:#00ff66;padding:10px;font-weight:bold}
.timer{color:#ff5252;font-size:14px;margin-top:5px}

.wheel-box{position:relative;width:300px;height:300px;margin:20px auto}
.arrow{
 position:absolute;top:-15px;left:50%;transform:translateX(-50%);
 width:0;height:0;border-left:15px solid transparent;
 border-right:15px solid transparent;border-bottom:25px solid red;z-index:10}
canvas{width:100%;height:100%;border-radius:50%}

button{
 padding:15px 35px;font-size:18px;background:#ff5722;
 color:#fff;border:none;border-radius:8px;cursor:pointer}
button:disabled{background:#aaa}

/* popup */
.popup{
 position:fixed;top:0;left:0;right:0;bottom:0;
 background:rgba(0,0,0,.6);display:none;
 align-items:center;justify-content:center;z-index:99}
.popup div{
 background:#fff;padding:25px;border-radius:10px;width:80%}

/* LIVE */
.live-btn{
 position:fixed;top:80px;right:15px;
 background:#ff0000;color:#fff;
 padding:8px 14px;border-radius:20px;
 font-size:14px;font-weight:bold;
 display:flex;align-items:center;gap:6px;
 animation:blink 1s infinite;z-index:999;
 box-shadow:0 0 10px rgba(255,0,0,.7)}
.live-dot{
 width:8px;height:8px;background:#00ff3c;
 border-radius:50%;animation:pulse 1s infinite}
@keyframes blink{0%{opacity:1}50%{opacity:.6}100%{opacity:1}}
@keyframes pulse{0%{transform:scale(1)}50%{transform:scale(1.6)}100%{transform:scale(1)}}
</style>
</head>

<body>

<!-- LIVE -->
<div class="live-btn">
 <div class="live-dot"></div>
 <span id="liveCount">61,234+</span> Ä‘ang chÆ¡i
</div>

<h1>VÃ²ng quay may máº¯n</h1>

<div class="top-bar">
ðŸŽ« LÆ°á»£t cÃ²n láº¡i: <span id="turns"></span>
<div class="timer" id="timer"></div>
</div>

<div class="wheel-box">
 <div class="arrow"></div>
 <canvas id="wheel" width="300" height="300"></canvas>
</div>

<button id="spinBtn">ðŸŽ¯ QUAY NGAY</button>

<div class="popup" id="popup">
 <div>
  <h3 id="result"></h3>
  <button onclick="closePopup()">OK</button>
 </div>
</div>

<script>
/* ===== LIVE COUNT ===== */
let live=61234;
setInterval(()=>{
 let c=Math.floor(Math.random()*50)+1;
 live+=Math.random()>0.5?c:-c;
 if(live<60000) live=60000;
 document.getElementById("liveCount").innerText=live.toLocaleString()+"+";
},2000);

/* ===== PRIZES ===== */
const prizes=[
 "Äiá»‡n thoáº¡i Samsung", // 0 âŒ váº­t lÃ½
 "MÃ¡y sáº¥y tÃ³c",        // 1 âŒ váº­t lÃ½
 "BÃ n lÃ  ðŸ”¥",          // 2 âŒ váº­t lÃ½
 "+50.000Ä‘", "+100.000Ä‘", "+200.000Ä‘", "+300.000Ä‘", "+500.000Ä‘",
 "-70.000Ä‘", "-80.000Ä‘", "-90.000Ä‘", "-200.000Ä‘",
 "Máº¥t lÆ°á»£t", "ThÃªm lÆ°á»£t", "ChÃºc may máº¯n",
 "3 giá» quÃ  Táº¿t"       // 15 âŒ váº­t lÃ½
];

/* âŒ CÃC Ã” Váº¬T LÃ â€“ KHÃ”NG BAO GIá»œ TRÃšNG */
const blocked=[0,1,2,15];

/* âœ… CHá»ˆ CHá»ŒN Ã” ÄÆ¯á»¢C PHÃ‰P */
const allowed=prizes.map((p,i)=>({p,i}))
                     .filter(x=>!blocked.includes(x.i));

const colors=["#FFD54F","#4FC3F7","#F48FB1","#66BB6A","#26A69A",
"#80CBC4","#FFCA28","#FFA726","#FF7043","#8D6E63","#D32F2F",
"#5D4037","#42A5F5","#AB47BC","#9E9E9E","#FBC02D"];

const canvas=document.getElementById("wheel");
const ctx=canvas.getContext("2d");
const center=150,radius=150;
const slice=2*Math.PI/prizes.length;
let angle=0,spinning=false;

/* ===== TURNS + TIMER ===== */
let turns=localStorage.turns?+localStorage.turns:2;
let nextTime=localStorage.nextTime||0;

function draw(){
 ctx.clearRect(0,0,300,300);
 for(let i=0;i<prizes.length;i++){
  let start=angle+i*slice;
  ctx.beginPath();
  ctx.moveTo(center,center);
  ctx.arc(center,center,radius,start,start+slice);
  ctx.fillStyle=colors[i];ctx.fill();
  ctx.save();
  ctx.translate(center,center);
  ctx.rotate(start+slice/2);
  ctx.textAlign="right";
  ctx.font="bold 12px Arial";
  ctx.fillStyle="#000";
  ctx.fillText(prizes[i],radius-10,5);
  ctx.restore();
 }
}
draw();

function updateUI(){
 document.getElementById("turns").innerText=turns;
 document.getElementById("spinBtn").disabled=turns<=0;
}

function countdown(){
 if(turns>0){timer.innerText="";return;}
 let d=nextTime-Date.now();
 if(d<=0){
  turns=2;localStorage.turns=2;
  updateUI();return;
 }
 let h=Math.floor(d/3600000);
 let m=Math.floor(d%3600000/60000);
 let s=Math.floor(d%60000/1000);
 timer.innerText=`â³ CÃ²n ${h}:${m.toString().padStart(2,"0")}:${s.toString().padStart(2,"0")}`;
}
setInterval(countdown,1000);
updateUI();

spinBtn.onclick=()=>{
 if(spinning||turns<=0)return;
 turns--;localStorage.turns=turns;
 if(turns==0){
  nextTime=Date.now()+12*60*60*1000;
  localStorage.nextTime=nextTime;
 }
 updateUI();spinning=true;

 const win=allowed[Math.floor(Math.random()*allowed.length)];
 const target=win.i;
 const stop=(3*Math.PI/2)-(target*slice)-slice/2;
 let speed=0.3;

 const run=setInterval(()=>{
  angle+=speed;speed*=0.99;draw();
  if(speed<0.002){
   angle=stop;draw();spinning=false;clearInterval(run);
   result.innerText="ðŸŽ‰ Káº¿t quáº£: "+prizes[target];
   popup.style.display="flex";
  }
 },20);
};

function closePopup(){popup.style.display="none";}
</script>

</body>
</html>
